"""
This tool is 98% insired by Noah Wenzel's tool.

This tool extracts the first ID (shipment ID or canada post shipment ID)
and createds a comma-separated list of those IDs.
"""

# paste the text you copied from the "Please manifest or void these {carrier - typically speedee or canada post} shipments" email
copied_email = """
 864521644856295954 	 4012709179908362 	 2022-02-14T16:31:36 
 506901644856467385 	 4012709180081368 	 2022-02-14T16:34:28 
 456861644856491669 	 4012709180099363 	 2022-02-14T16:34:52 
 796811644856523487 	 4012709180139366 	 2022-02-14T16:35:24 
 506901644856565485 	 4012709180549363 	 2022-02-14T16:36:06 
 456861644856607191 	 4012709180588362 	 2022-02-14T16:36:48 
 506901644856789086 	 4012709180755368 	 2022-02-14T16:39:50 
 456861644857271541 	 4012709181856361 	 2022-02-14T16:47:52 
 864521644857275951 	 4012709181791365 	 2022-02-14T16:47:56 
 864521644857327491 	 4012709182229362 	 2022-02-14T16:48:48 
 796811644857362329 	 4012709181905366 	 2022-02-14T16:49:23 
 386741644857386412 	 4012709182260365 	 2022-02-14T16:49:47 
 796811644857428878 	 4012709182280363 	 2022-02-14T16:50:29 
 506901644857564101 	 4012709182349367 	 2022-02-14T16:52:45 
 796811644857686581 	 4012709182553368 	 2022-02-14T16:54:47 
 386741644857718032 	 4012709182868363 	 2022-02-14T16:55:19 
 506901644857718435 	 4012709182683362 	 2022-02-14T16:55:19 
 456861644857718589 	 4012709182869360 	 2022-02-14T16:55:19 
 506901644857722435 	 4012709182870366 	 2022-02-14T16:55:24 
 506901644857723642 	 4012709182566368 	 2022-02-14T16:55:24 
 386741644857723912 	 4012709182567365 	 2022-02-14T16:55:24 
 506901644857735712 	 4012709182575360 	 2022-02-14T16:55:36 
 456861644857735858 	 4012709182576367 	 2022-02-14T16:55:36 
 386741644857747094 	 4012709182580364 	 2022-02-14T16:55:47 
 386741644857747057 	 4012709182885360 	 2022-02-14T16:55:48 
 796811644857757402 	 4012709182893365 	 2022-02-14T16:55:58 
 456861644857757433 	 4012709182894362 	 2022-02-14T16:55:58 
 506901644857757572 	 4012709182701363 	 2022-02-14T16:55:58 
 456861644857757737 	 4012709182895369 	 2022-02-14T16:55:58 
 386741644857763315 	 4012709182897363 	 2022-02-14T16:56:04 
 506901644857763441 	 4012709182898360 	 2022-02-14T16:56:04 
 864521644857769817 	 4012709182903361 	 2022-02-14T16:56:10 
 796811644857771957 	 4012709182707365 	 2022-02-14T16:56:12 
 506901644857775505 	 4012709182908366 	 2022-02-14T16:56:16 
 506901644858138721 	 4012709183453360 	 2022-02-14T17:02:19 
 796811644858185308 	 4012709183470367 	 2022-02-14T17:03:06 
 456861644858216283 	 4012709183338360 	 2022-02-14T17:03:37 
 796811644858245454 	 4012709183347362 	 2022-02-14T17:04:06 
 506901644858775379 	 4012709183751367 	 2022-02-14T17:12:57 
 796811644858799118 	 4012709184102366 	 2022-02-14T17:13:20 
 456861644858990912 	 4012709184649366 	 2022-02-14T17:16:31 
 506901644859010158 	 4012709184667360 	 2022-02-14T17:16:51 
 796811644859133354 	 4012709184522362 	 2022-02-14T17:18:54 
 864521644859154840 	 4012709185009367 	 2022-02-14T17:19:15 
 506901644860556960 	 4012709186654368 	 2022-02-14T17:42:38 
 456861644862660290 	 4012709189866362 	 2022-02-14T18:17:41 
 864521644862701579 	 4012709190036365 	 2022-02-14T18:18:22 
 796811644862718012 	 4012709190220368 	 2022-02-14T18:18:38 
 864521644864512428 	 4012709193201364 	 2022-02-14T18:48:33 
 386741644865231844 	 4012709195010360 	 2022-02-14T19:00:32 
 796811644865640975 	 4012709195192363 	 2022-02-14T19:07:22 
 506901644867067496 	 4012709197808361 	 2022-02-14T19:31:08 
 386741644867067512 	 4012709197767361 	 2022-02-14T19:31:08 
 796811644867067509 	 4012709197809368 	 2022-02-14T19:31:08 
 796811644867067496 	 4012709197810364 	 2022-02-14T19:31:08 
 796811644867080298 	 4012709197817363 	 2022-02-14T19:31:21 
 506901644867080327 	 4012709197774369 	 2022-02-14T19:31:21 
 386741644867080312 	 4012709197299367 	 2022-02-14T19:31:21 
 456861644867080414 	 4012709197775366 	 2022-02-14T19:31:21 
 796811644867086651 	 4012709197778367 	 2022-02-14T19:31:27 
 864521644867086904 	 4012709197780360 	 2022-02-14T19:31:27 
 386741644867086907 	 4012709197779364 	 2022-02-14T19:31:27 
 796811644867087896 	 4012709197781367 	 2022-02-14T19:31:28 
 796811644867092592 	 4012709197304368 	 2022-02-14T19:31:33 
 864521644867092968 	 4012709197305365 	 2022-02-14T19:31:33 
 864521644867093112 	 4012709197786362 	 2022-02-14T19:31:34 
 506901644867098994 	 4012709197824361 	 2022-02-14T19:31:39 
 456861644867103335 	 4012709197309363 	 2022-02-14T19:31:44 
 386741644867104002 	 4012709197828369 	 2022-02-14T19:31:44 
 506901644867104061 	 4012709197792363 	 2022-02-14T19:31:44 
 864521644867104779 	 4012709197310369 	 2022-02-14T19:31:45 
 456861644867107283 	 4012709197794367 	 2022-02-14T19:31:48 
 456861644867108710 	 4012709197796361 	 2022-02-14T19:31:49 
 456861644867108940 	 4012709197312363 	 2022-02-14T19:31:49 
 386741644867109959 	 4012709197313360 	 2022-02-14T19:31:50 
 386741644867111193 	 4012709197830362 	 2022-02-14T19:31:52 
 386741644867112651 	 4012709197832366 	 2022-02-14T19:31:53 
 506901644867113665 	 4012709197833363 	 2022-02-14T19:31:54 
 506901644867114901 	 4012709197835367 	 2022-02-14T19:31:55 
 796811644867116005 	 4012709197836364 	 2022-02-14T19:31:56 
 864521644867116719 	 4012709197800365 	 2022-02-14T19:31:57 
 506901644867126903 	 4012709197845366 	 2022-02-14T19:32:07 
 864521644867126985 	 4012709197846363 	 2022-02-14T19:32:07 
 506901644867131270 	 4012709197327367 	 2022-02-14T19:32:12 
 864521644867136207 	 4012709197849364 	 2022-02-14T19:32:17 
 796811644867142097 	 4012709197851367 	 2022-02-14T19:32:22 
 456861644867142104 	 4012709198015362 	 2022-02-14T19:32:23 
 796811644867142197 	 4012709197852364 	 2022-02-14T19:32:23 
 864521644867142078 	 4012709198014365 	 2022-02-14T19:32:23 
 456861644867147612 	 4012709198021363 	 2022-02-14T19:32:28 
 506901644867149255 	 4012709197857369 	 2022-02-14T19:32:30 
 864521644867149307 	 4012709197337366 	 2022-02-14T19:32:30 
 456861644867149580 	 4012709197338363 	 2022-02-14T19:32:30 
 796811644867152112 	 4012709197859363 	 2022-02-14T19:32:32 
 864521644867156294 	 4012709197861366 	 2022-02-14T19:32:37 
 456861644868302594 	 4012709199363363 	 2022-02-14T19:51:43 
 386741644868437583 	 4012709199626369 	 2022-02-14T19:53:58 
 864521644868718789 	 4012709199905365 	 2022-02-14T19:58:39 
 864521644868785876 	 4012709199930367 	 2022-02-14T19:59:47 
 386741644869637726 	 4012709201182364 	 2022-02-14T20:13:58 
 506901644869689129 	 4012709200998362 	 2022-02-14T20:14:50 
 864521644869885877 	 4012709201355362 	 2022-02-14T20:18:06 
 796811644869971699 	 4012709201548368 	 2022-02-14T20:19:32 
 456861644869997643 	 4012709201695369 	 2022-02-14T20:19:58 
 864521644870175481 	 4012709201915368 	 2022-02-14T20:22:56 
 864521644870319945 	 4012709202060364 	 2022-02-14T20:25:20 
 506901644871995424 	 4012709204117363 	 2022-02-14T20:53:16 
 386741644872618410 	 4012709204701364 	 2022-02-14T21:03:39 
 506901644874012641 	 4012709206065365 	 2022-02-14T21:26:53 
 506901644874911785 	 4012709207457367 	 2022-02-14T21:41:53 
 506901644874930151 	 4012709207377368 	 2022-02-14T21:42:11 
 864521644874952856 	 4012709207385363 	 2022-02-14T21:42:33 
 864521644875271494 	 4012709207526360 	 2022-02-14T21:47:52 
 864521644875485660 	 4012709207709367 	 2022-02-14T21:51:26 
 456861644875754164 	 4012709207774365 	 2022-02-14T21:55:55 
 796811644875849183 	 4012709208124367 	 2022-02-14T21:57:30 
 456861644875929038 	 4012709207795360 	 2022-02-14T21:58:49 
 386741644876458873 	 4012709208491360 	 2022-02-14T22:07:39 
 456861644876724526 	 4012709208376360 	 2022-02-14T22:12:05 
 456861644878396887 	 4012709209809362 	 2022-02-14T22:39:57 
 796811644880181992 	 4012709210358361 	 2022-02-14T23:09:43 
 796811644882141139 	 4012709211352368 	 2022-02-14T23:42:22 
 386741644882819513 	 4012709211171365 	 2022-02-14T23:53:40 



"""



email = copied_email.split()
print(email)

CPIDs = ''

for i in range (len(email)):

    # get canada post shipment ID
    if i % 3 == 0:
        CPIDs=CPIDs+email[i]+", "

final = CPIDs[:-2] # Remove the extra ', ' that was added in the above loop to the last ID
print(final)

with open('shipment_ids.csv', 'w') as f:
    f.write(final)